@model GoodNewsAggregator.Models.ViewModels.News.NewsListWithRssWithPagination

@{
    ViewData["Title"] = "News";
}

@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "__AjaxAntiForgeryForm" }))
{
    @Html.AntiForgeryToken()
}

<div class="row text-center">
    <h1>Новости</h1>
</div>


<div class="row">

    <partial name="_RssList" model="Model.RssList" />


    <div class="col-md-4">
        <form asp-action="Aggregate">
            <input type="submit" value="Submit" class="btn btn-danger" />
        </form>
    </div>

</div>

<p>
    <a asp-action="Create">Create New</a>
</p>

<partial name="_NewsLists" model="Model.NewsLists" />

<partial name="_Pagination" model="Model.Pagination" />


<div id="outputField">
    @{ await Html.RenderPartialAsync("_NewsLists", Model.NewsLists);}
</div>




@section scripts
{

    <script>

    rssIds = [];

function OnChangeCheckBoxFunc(e) {
    var rssId = e.value;

    if (rssIds.indexOf(rssId) > -1)
    {
        var elementIndex = rssIds.indexOf(rssId);
        rssIds.splice(elementIndex, 1);
    }
    else
    {
        rssIds.push(rssId);
    }
    getCheckedCheckBoxesMove();
}

function getCheckedCheckBoxesMove() {
    var form = $('#__AjaxAntiForgeryForm');
    var token = $('input[name="__RequestVerificationToken"]', form).val();
    $.ajax({
        type: 'POST',
        url: '@Url.Action("Index", "News")',
        data: {
            __RequestVerificationToken: token,
            rssIds: rssIds,
        },
        //dataType: 'json',
        success: function (response) {
            console.log('success!');
            $('#outputField').html(response);
        }
    });
}

    </script>
}
